<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Teacher Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-100 font-sans flex min-h-screen">

    <aside class="w-64 bg-slate-800 text-white flex flex-col shadow-lg fixed h-full">
      <div class="p-6 text-center border-b border-slate-700">
        <h2 class="text-lg font-bold">{{ teacher.username }}</h2>
        <span class="text-xs bg-yellow-500 text-black px-2 py-1 rounded-full">Teacher</span>
      </div>
      <nav class="flex-1 p-4 space-y-2">
        <a href="/teacher/dashboard" class="block py-2 px-4 rounded bg-slate-700">Profile</a>
        <a href="/teacher/create-assignment" class="block py-2 px-4 rounded hover:bg-slate-700">Create Assignment</a>
        <a href="/teacher/assignments" class="block py-2 px-4 rounded hover:bg-slate-700">View Assignments</a>
        <a href="/teacher/attendance" class="block py-2 px-4 rounded hover:bg-slate-700 text-green-400">Mark Attendance</a>
        <a href="/logout" class="block py-2 px-4 rounded hover:bg-red-600 mt-8">Logout</a>
      </nav>
    </aside>

    <main class="flex-1 p-8 ml-64 overflow-y-auto">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="mb-6 space-y-2">
                    {% for category, message in messages %}
                        <div class="p-3 rounded text-white font-bold
                                    {% if category == 'success' %} bg-green-500
                                    {% else %} bg-blue-500 {% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-2xl font-bold mb-4">Assigned Classes</h2>
            <div class="flex flex-wrap gap-2">
                {% if teacher.assigned_classes %}
                    {% for c in teacher.assigned_classes %}
                        <span class="bg-blue-100 text-blue-800 border border-blue-200 px-3 py-1 rounded text-sm font-bold">
                            {{ c.class_name }} - {{ c.division }}
                        </span>
                    {% endfor %}
                {% else %}
                    <span class="text-red-500 font-bold italic">No classes assigned. Use the form below to add one!</span>
                {% endif %}
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold mb-4">Update Profile & Add Classes</h2>
            <form method="POST" action="/teacher/update-profile" class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <input type="email" name="email" value="{{ teacher.email or '' }}" placeholder="Email" class="p-2 border rounded">
                    <input type="text" name="subject" value="{{ teacher.subject or '' }}" placeholder="Subject" class="p-2 border rounded">
                </div>
                <textarea name="bio" rows="2" placeholder="Bio" class="w-full p-2 border rounded">{{ teacher.bio or '' }}</textarea>

                <div class="bg-yellow-50 p-4 border border-yellow-200 rounded mt-4">
                    <h3 class="font-bold mb-2 text-sm text-yellow-800">ADD NEW CLASS (Required for Attendance)</h3>
                    <div class="flex gap-2">
                        <input type="text" name="new_class_name" placeholder="Class Name (e.g. TY-CS)" class="p-2 border rounded flex-1">
                        <input type="text" name="new_division" placeholder="Division (e.g. A)" class="p-2 border rounded w-24 text-center">
                        <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded font-bold hover:bg-green-700">Add Class</button>
                    </div>
                </div>
            </form>
        </div>
    </main>
</body>
</html>